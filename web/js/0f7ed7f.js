$(function(){publicationList()});$("body").on("click","[action='listingPaginatedNext']",function(e,waypoint){if(waypoint){waypoint.destroy()}publicationList(false,$(this).attr("offset"))});function initMyPublicationsPaginateNextWaypoint(){var waypoints=$("#moreResults").waypoint({handler:function(direction){if(direction=="down"){$("[action='listingPaginatedNext']").trigger("click",this)}},offset:"bottom-in-view"})}function publicationList(init,offset){init=typeof init==="undefined"?true:init;offset=typeof offset==="undefined"?0:offset;var xhrPath=getXhrPath(xhrRoute,"document",xhrMethod,RETURN_HTML);$.ajax({type:"POST",url:xhrPath,data:{offset:offset},dataType:"json",beforeSend:function(xhr){xhrBeforeSend(xhr,1)},statusCode:{404:function(){xhr404()},500:function(){xhr500()}},error:function(jqXHR,textStatus,errorThrown){xhrError(jqXHR,textStatus,errorThrown)},success:function(data){if(data["error"]){$("#infoBoxHolder .boxError .notifBoxText").html(data["error"]);$("#infoBoxHolder .boxError").show()}else{$("#timelineScrollNav").remove();if(init){$("#listContent").html(data["html"])}else{$("#listContent").append(data["html"])}}$("#ajaxGlobalLoader").hide();initMyPublicationsPaginateNextWaypoint();fullImgLiquid()}})}
var notesChartInstance;$("body").on("click","[action='notesPaginatePrevChart']",function(e){documentNotesCharts($("#modalMyPostsCharts").attr("uuid"),$("#modalMyPostsCharts").attr("type"),$(this).attr("startAt"))});$("body").on("click","[action='notesPaginateNextChart']",function(e){documentNotesCharts($("#modalMyPostsCharts").attr("uuid"),$("#modalMyPostsCharts").attr("type"),$(this).attr("startAt"))});function documentCharts(uuid,type,startAt){documentNotesCharts(uuid,type,startAt)}function documentNotesCharts(uuid,type,startAt){if(typeof startAt==="undefined"){var startAt=new Date;var startAt=new Date(startAt.getFullYear(),startAt.getMonth(),1);var startAt=moment(startAt).format("YYYY-MM-DD")}var xhrPath=getXhrPath(ROUTE_MODAL_DOCUMENT_STATS_NOTES_EVOLUTION,"document","statsNotesEvolution",RETURN_HTML);var localLoader=$("#myPostsNoteStats").find(".ajaxLoader").first();$.ajax({type:"POST",url:xhrPath,data:{uuid:uuid,type:type,startAt:startAt},dataType:"json",beforeSend:function(xhr){xhrBeforeSend(xhr,localLoader)},statusCode:{404:function(){xhr404(localLoader)},500:function(){xhr500(localLoader)}},error:function(jqXHR,textStatus,errorThrown){xhrError(jqXHR,textStatus,errorThrown,localLoader)},success:function(data){localLoader.hide();if(data["error"]){$("#infoBoxHolder .boxError .notifBoxText").html(data["error"]);$("#infoBoxHolder .boxError").show()}else{if(notesChartInstance){notesChartInstance.destroy()}var lineChartData={labels:data["labels"],datasets:[{data:data["data"],label:"Notes points",fillColor:"rgba(229, 108, 64, 0.3)",strokeColor:"#e56c40",pointColor:"#e56c40",pointStrokeColor:"#fff",pointHighlightFill:"#fff",pointHighlightStroke:"#e56c40"}]};notesChartInstance=loadDataCharts("myPostsNote",lineChartData);$("#notesChartNavPrev").attr("startAt",data["datePrev"]);$("#notesChartNavNext").attr("startAt",data["dateNext"]);$("#notesChartNavPrev").show();$("#notesChartNavNext").show()}}})}