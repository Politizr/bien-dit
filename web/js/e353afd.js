$(function(){topListing();tagListing();debateListing();userListing();geoListing();suggestionListing()});$("body").on("change",".mapFilter",function(e){e.preventDefault();topListing($("#mapFilter").attr("uuid"))});$("body").on("click","[action='mapZoom']",function(){topListing($(this).attr("uuid"))});$("body").on("change",".tagFilter",function(e){e.preventDefault();tagListing()});$("body").on("change",".debateFilter",function(e){e.preventDefault();debateListing()});$("body").on("change",".userFilter",function(e){e.preventDefault();userListing()});function updateSuiteLink(){$("#modalMoreDebates").attr("defaultFilterDate",$("#mapFilter input:checked").val());$("#modalMoreUsers").attr("defaultFilterDate",$("#mapFilter input:checked").val())}function topListing(geoTagUuid){geoTagUuid=typeof geoTagUuid==="undefined"?null:geoTagUuid;var datas=$("#mapFilter").serializeArray();if($.isEmptyObject(datas)){datas.push({name:"mapFilterDate[]",value:"lastMonth"})}datas.push({name:"geoTagUuid",value:geoTagUuid});var xhrPath=getXhrPath(ROUTE_DASHBOARD_MAP,"dashboard","map",RETURN_HTML);var localLoader=$(".dbMap").find(".ajaxLoader").first();$.ajax({type:"POST",url:xhrPath,data:datas,dataType:"json",beforeSend:function(xhr){xhrBeforeSend(xhr,localLoader)},statusCode:{404:function(){xhr404(localLoader)},500:function(){xhr500(localLoader)}},error:function(jqXHR,textStatus,errorThrown){xhrError(jqXHR,textStatus,errorThrown,localLoader)},success:function(data){if(data["error"]){$("#infoBoxHolder .boxError .notifBoxText").html(data["error"]);$("#infoBoxHolder .boxError").show()}else{$(".dbMap").html(data["html"]);updateSuiteLink();fullImgLiquid()}localLoader.hide()}})}function debateListing(){var datas=$("#debateFilter").serializeArray();if($.isEmptyObject(datas)){datas.push({name:"debateFilterDate[]",value:"lastMonth"})}var xhrPath=getXhrPath(ROUTE_DASHBOARD_TOP_DEBATES,"dashboard","topDebates",RETURN_HTML);var localLoader=$(".dbPopularDebates").find(".ajaxLoader").first();$.ajax({type:"POST",url:xhrPath,data:datas,dataType:"json",beforeSend:function(xhr){xhrBeforeSend(xhr,localLoader)},statusCode:{404:function(){xhr404(localLoader)},500:function(){xhr500(localLoader)}},error:function(jqXHR,textStatus,errorThrown){xhrError(jqXHR,textStatus,errorThrown,localLoader)},success:function(data){if(data["error"]){$("#infoBoxHolder .boxError .notifBoxText").html(data["error"]);$("#infoBoxHolder .boxError").show()}else{$(".dbPopularDebates").html(data["html"]);fullImgLiquid()}localLoader.hide()}})}function userListing(){var datas=$("#userFilter").serializeArray();if($.isEmptyObject(datas)){datas.push({name:"userFilterDate[]",value:"lastMonth"})}var xhrPath=getXhrPath(ROUTE_DASHBOARD_TOP_USERS,"dashboard","topUsers",RETURN_HTML);var localLoader=$(".dbPopularProfiles").find(".ajaxLoader").first();$.ajax({type:"POST",url:xhrPath,data:datas,dataType:"json",beforeSend:function(xhr){xhrBeforeSend(xhr,localLoader)},statusCode:{404:function(){xhr404(localLoader)},500:function(){xhr500(localLoader)}},error:function(jqXHR,textStatus,errorThrown){xhrError(jqXHR,textStatus,errorThrown,localLoader)},success:function(data){if(data["error"]){$("#infoBoxHolder .boxError .notifBoxText").html(data["error"]);$("#infoBoxHolder .boxError").show()}else{$(".dbPopularProfiles").html(data["html"]);fullImgLiquid()}localLoader.hide()}})}function geoListing(){var xhrPath=getXhrPath(ROUTE_DASHBOARD_GEO,"dashboard","geoTaggedUser",RETURN_HTML);var localLoader=$(".dbCloseToYou").find(".ajaxLoader").first();$.ajax({type:"POST",url:xhrPath,dataType:"json",beforeSend:function(xhr){xhrBeforeSend(xhr,localLoader)},statusCode:{404:function(){xhr404(localLoader)},500:function(){xhr500(localLoader)}},error:function(jqXHR,textStatus,errorThrown){xhrError(jqXHR,textStatus,errorThrown,localLoader)},success:function(data){if(data["error"]){$("#infoBoxHolder .boxError .notifBoxText").html(data["error"]);$("#infoBoxHolder .boxError").show()}else{$(".dbCloseToYou").html(data["html"]);fullImgLiquid()}localLoader.hide()}})}function suggestionListing(){var xhrPath=getXhrPath(ROUTE_DASHBOARD_SUGGESTION,"dashboard","suggestion",RETURN_HTML);var localLoader=$(".dbSuggestions").find(".ajaxLoader").first();$.ajax({type:"POST",url:xhrPath,dataType:"json",beforeSend:function(xhr){xhrBeforeSend(xhr,localLoader)},statusCode:{404:function(){xhr404(localLoader)},500:function(){xhr500(localLoader)}},error:function(jqXHR,textStatus,errorThrown){xhrError(jqXHR,textStatus,errorThrown,localLoader)},success:function(data){if(data["error"]){$("#infoBoxHolder .boxError .notifBoxText").html(data["error"]);$("#infoBoxHolder .boxError").show()}else{$(".dbSuggestions").html(data["html"]);fullImgLiquid()}localLoader.hide()}})}