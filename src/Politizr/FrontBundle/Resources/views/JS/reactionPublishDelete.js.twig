<script>
    // Publication debat
    $('body').on('click', "[action='reaction-publish']", function(e){
        console.log('*** click publish');
        
        bootbox.confirm('Une fois publié, vous ne pourrez plus modifier votre réaction. Voulez-vous publier votre réaction?', function(result) {
            if (result) {
                $.ajax({
                    type: 'POST',
                    dataType: 'json',
                    url : "{{ path('ReactionPublish') }}",
                    data: { id: $("[action='reaction-publish']").attr('object-id'), 'url': $("[action='reaction-publish']").attr('url') },
                    dataType: 'json',
                    {% include 'PolitizrFrontBundle:JS:ajaxError.js.twig' %}
                    success: function(data) {
                        if (data['error']) {
                            $('#ajaxGlobalLoader').hide();
                            $('#infoBoxHolder .boxError .notifBoxText').html(data['error']);
                            $('#infoBoxHolder .boxError').show();
                        } else {
                            // redirection
                            window.location = data['redirectUrl'];
                        }
                    }
                });
            }
        });
    });


    // Suppression debat
    $('body').on('click', "[action='reaction-delete']", function(e){
        console.log('*** click delete');

        bootbox.confirm('Êtes-vous sûr de vouloir supprimer votre brouillon?', function(result) {
            if (result) {
                $.ajax({
                    type: 'POST',
                    dataType: 'json',
                    url : "{{ path('ReactionDelete') }}",
                    data: { id: $('#reaction_id').val(), url: $("[action='reaction-delete']").attr('url') },
                    dataType: 'json',
                    {% include 'PolitizrFrontBundle:JS:ajaxError.js.twig' %}
                    success: function(data) {
                        if (data['error']) {
                            $('#ajaxGlobalLoader').hide();
                            $('#infoBoxHolder .boxError .notifBoxText').html(data['error']);
                            $('#infoBoxHolder .boxError').show();
                        } else {
                            // redirection
                            window.location = data['redirectUrl'];
                        }
                    }
                });
            }
        });
    });
</script>