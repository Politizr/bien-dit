<script type="text/javascript">
    // show / hide connection / lost password boxes
    $("body").on("click", "[action='showLostPasswordBox']", function(e) {
        console.log('*** click showLostPasswordBox');

        $('#boxLostPassword').show();
        $('#boxLogin').hide();
    });

    $("body").on("click", "[action='showLoginBox']", function(e) {
        console.log('*** click showLoginBox');

        $('#boxLostPassword').hide();
        $('#boxLogin').show();
    });

    // clic connexion
    $("body").on("click", "[action='login']", function(e) {
        console.log('*** click login');

        $.ajax({
            type: 'POST',
            url: "{{ path('LoginCheck') }}",
            data: $("#formLogin").serialize(),
            dataType: 'json',
            {% include 'PolitizrFrontBundle:JS:ajaxError.js.twig' %}
            success: function(data) {
                if (data['error']) {
                    $('#ajaxGlobalLoader').hide();
                    $('#infoBoxHolder .boxError .notifBoxText').html(data['error']);
                    $('#infoBoxHolder .boxError').show();
                } else {
                    // redirection
                    window.location = data['redirectUrl'];
                }
            }
        });
    });

    // clic mot de passe oublié
    $("body").on("click", "[action='reinitPassword']", function(e) {
        console.log('*** click reinitPassword');

        $.ajax({
            type: 'POST',
            url: "{{ path('LostPasswordCheck') }}",
            data: $("#formLostPassword").serialize(),
            dataType: 'json',
            {% include 'PolitizrFrontBundle:JS:ajaxError.js.twig' %}
            success: function(data) {
                $('#ajaxGlobalLoader').hide();
                if (data['error']) {
                    $('#infoBoxHolder .boxError .notifBoxText').html(data['error']);
                    $('#infoBoxHolder .boxError').show();
                } else {
                    // close modal
                    $("[action='modalClose']").trigger('click');

                    // notif message
                    $("#infoBoxHolder .boxSuccess .notifBoxText").html('Un nouveau mot de passe vient de vous être envoyé par email.');
                    $('#infoBoxHolder .boxSuccess').show();
                }
            }
        });
    });


</script>
