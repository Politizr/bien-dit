<script type="text/javascript">
	// **************************** //
	//      Initialisation
	// **************************** //
	$(document).ready(function () {
	});

	// **************************** //
	//      ACTIONS SIMPLES
	// **************************** //
	$("body").on("click", "button[action='connect-me']", function(e) {
		if ($("#connexion-box").is(":visible")) {
			$("#connexion-box").slideUp("slow");
		} else {
	        $("#connexion-box").slideDown("slow");
	        $('#box-login').show();
	        $('#box-lost-password').hide();
	    }
    });

	$("body").on("click", "button[action='btn-lost-password']", function(e) {
		$('#box-lost-password').show();
		$('#box-login').hide();
    });

	$("body").on("click", "button[action='btn-login']", function(e) {
		$('#box-lost-password').hide();
		$('#box-login').show();
    });

	// **************************** //
	//      POST
	// **************************** //
	// clic connexion
	$("body").on("click", "button[action='btn-submit-login']", function(e) {
		$.ajax({
		  	type: 'POST',
		  	url: "{{ path('LoginCheck') }}",
		  	data: $("#form-login").serialize(),
		  	dataType: 'json',
		  	{% include 'PolitizrFrontBundle:JS:ajaxError.js.twig' %}
		  	success: function(data) {
		    	if (data['error']) {
		    	  	$('#ajax-loader').hide();
		    	  	$('.alert.alert-danger').html(data['error']);
		    		$('.alert.alert-danger').show();
		    	} else {
		    	  	// redirection
		    	  	window.location = data['redirectUrl'];
		    	}
		    }
		});
	});

	// clic mot de passe oublié
	$("body").on("click", "button[action='btn-submit-lost-password']", function(e) {
		$.ajax({
		  	type: 'POST',
		  	url: "{{ path('LostPasswordCheck') }}",
		  	data: $("#form-lost-password").serialize(),
		  	dataType: 'json',
		  	{% include 'PolitizrFrontBundle:JS:ajaxError.js.twig' %}
		  	success: function(data) {
		    	if (data['error']) {
		    	  	$('#ajax-loader').hide();
		    	  	$('.alert.alert-danger').html(data['error']);
		    		$('.alert.alert-danger').show();
		    	} else {
		    	  	$('#ajax-loader').hide();

		    	  	// fermeture overlay & notif
		    	  	$("#connexion-box").hide();

		    	  	$(".alert.alert-success").html('Un nouveau mot de passe vient de vous être envoyé par email.');
		    	  	$(".alert.alert-success").show();
		    	}
		    }
		});
	});


</script>
