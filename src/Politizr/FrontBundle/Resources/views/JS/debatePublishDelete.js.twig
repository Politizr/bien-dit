<script>
    // Publication debat
    $('body').on('click', "[action='debatePublish']", function(e){
        console.log('*** click publish');
        
        if (confirm('Une fois publié, vous ne pourrez plus modifier votre débat. Voulez-vous publier votre débat?')) {
            $.ajax({
                type: 'POST',
                dataType: 'json',
                url : "{{ path('DebatePublish') }}",
                data: { 'id': $(this).attr('subjectId'), 'url': $(this).attr('url') },
                dataType: 'json',
                {% include 'PolitizrFrontBundle:JS:ajaxError.js.twig' %}
                success: function(data) {
                    if (data['error']) {
                        $('#ajaxGlobalLoader').hide();
                        $('#infoBoxHolder.boxError.notifBoxText').html(data['error']);
                        $('#infoBoxHolder.boxError').show();
                    } else {
                        // redirection
                        window.location = data['redirectUrl'];
                    }
                }
            });
        }
    });

    // Suppression debat
    $('body').on('click', "[action='debateDelete']", function(e){
        console.log('*** click delete');

        if (confirm('Êtes-vous sûr de vouloir supprimer votre brouillon?')) {
            $.ajax({
                type: 'POST',
                dataType: 'json',
                url : "{{ path('DebateDelete') }}",
                data: { 'id': $('#debate_id').val(), 'url': $(this).attr('url') },
                dataType: 'json',
                {% include 'PolitizrFrontBundle:JS:ajaxError.js.twig' %}
                success: function(data) {
                    if (data['error']) {
                        $('#ajaxGlobalLoader').hide();
                        $('#infoBoxHolder.boxError.notifBoxText').html(data['error']);
                        $('#infoBoxHolder.boxError').show();
                    } else {
                        // redirection
                        window.location = data['redirectUrl'];
                    }
                }
            });
        }
    });
</script>