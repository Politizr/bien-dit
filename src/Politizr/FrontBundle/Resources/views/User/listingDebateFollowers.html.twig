{# beta #}
{% set layout = 'PolitizrFrontBundle::layoutPublic.html.twig' %}
{% if (isGrantedE() or isGrantedC()) %}
    {% set layout = 'PolitizrFrontBundle::layoutConnected.html.twig' %}
{% endif %}
{% extends layout %}

{% block title %}
    {{ parent() }} - Abonn√©s {{ debate.title }}
{% endblock title %}

{% block content %}
    <div id="content">
        <div class="headerFollowers">
            <a href="{{ path('DebateDetail', {'slug': debate.slug}) }}" class="goBack"><i class="icon-arrow-left"></i>Retour</a>
            <span>Profils suivant la discussion: <a href="{{ path('DebateDetail', {'slug': debate.slug}) }}">{{ debate.title }}</a></span>
        </div>
        <div id="userListing" class="withLoaderInside" uuid="{{ debate.uuid }}">
            {% include 'PolitizrFrontBundle:Navigation\\Xhr:_xhrLocalLoader.html.twig' %}
            <div class="listFollowers"></div>
        </div>
    </div>
{% endblock content %}

{% block sidebarContent %}
    <div class="sidebarSubject">
        <div class="sidebarAction">
            {% if app.user and app.user.id != debate.getPUserId %}
                <div class="sidebarFollow">
                    {% include 'PolitizrFrontBundle:Follow:_actionFollow.html.twig' with { 'subject': debate } only %}
                </div>
            {% endif %}
            <div class="actionsBox">
                <div class="miniActions">
                    {% include 'PolitizrFrontBundle:Reaction:_actionNew.html.twig' with { 'document': debate } only %}
                </div>  
                <div class="notation withLoaderInside">
                    {% include 'PolitizrFrontBundle:Reputation:_noteAction.html.twig' with { 'subject': debate } only %}
                </div>
            </div>
            {# include('includes/share.php') #}
        </div>

        {% include 'PolitizrFrontBundle:Monitoring:_sidebarAbuse.html.twig' with { 'subject': debate } only %}

        {% if app.user and app.user.id == debate.pUserId %}
            {% include 'PolitizrFrontBundle:Monitoring:_sidebarAskForUpdate.html.twig' with { 'subject': debate } only %}
        {% endif %}

        <div class="sidebarSubjectFollowers withLoaderInside">
            {% include 'PolitizrFrontBundle:Navigation\\Xhr:_xhrLocalLoader.html.twig' %}
            <div id="subjectFollowers" uuid="{{ debate.uuid }}"></div>
        </div>    
    </div>
{% endblock sidebarContent %}

{% block javascriptFooter %}
    {{ parent() }}

    {% javascripts
        '@PolitizrFrontBundle/Resources/public/js/politizr/user/listing.js'
        '@PolitizrFrontBundle/Resources/public/js/politizr/pages/listingDebateFollowers.js'
        filter='uglifyjs2' %}
        <script src="{{ asset_url }}"></script>
    {% endjavascripts %}
{% endblock javascriptFooter %}
